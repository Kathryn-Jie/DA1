---
title: "Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(fpp2)
library(ggplot2)
library(dplyr)
library(plotly)
library(autoplotly)
```

```{r}
data1<-read.csv("Assignment.csv")
mydata<-ts(data1[,-1],start = 1990,end=2017,frequency = 1)
```

Overview
======================================================================

Column {data-width=1000}
-----------------------------------------------------------------------
### The number of deaths  caused by risk factors in Malaysia increased from 1990 to 2017. The main risk factor of death is high blood pressure.
```{r}
data2<-mydata[,3:5]
a1<-data2 %>% autoplot() +xlab("Year")+ylab("Number of deaths")
autoplotly(a1)
```


Forecast
======================================================================
Column {data-width=333}
-----------------------------------------------------------------------

### Trend
```{r}
valueBox("High blood pressure", icon = "swap_horizontal_line")
```


### 
```{r}
data1<-mydata[,5]
a<-data1 %>% forecast(h=5) %>%
  autoplot() +xlab("Year")+ylab("Number of deaths")
autoplotly(a)
```

Column {data-width=333}
-----------------------------------------------------------------------
### Trend
```{r}
valueBox("Obesity", icon = "swap_horizontal_line")
```

###
```{r}
data2<-mydata[,4]
b<-data2 %>% forecast(h=5) %>%
  autoplot() +xlab("Year")+ylab("Number of deaths")
autoplotly(b)
```

Column {data-width=334}
-----------------------------------------------------------------------

### Trend
```{r}
valueBox("Low Physical Activity", icon = "swap_horizontal_line")
```

### 
```{r}
data3<-mydata[,3]
c<-data3 %>% forecast(h=5) %>%
  autoplot() +xlab("Year")+ylab("Number of deaths")
autoplotly(c)
```

Relationship
======================================================================
Column {data-width=500}
-----------------------------------------------------------------------

Obesity

### Obesity has significant effect on number of deaths caused by high blood pressure
```{r}
valueBox("p-value < 2.2e-16", icon = "swap_horizontal_line")
```


### Strong, linear and positive effect
```{r}
d<-ggplot(mydata, aes(x=HighBloodPressure, y=Obesity)) + geom_point() + geom_smooth(method = "lm", se = FALSE)
ggplotly(d)
```

### Correlation
```{r}
valueBox("0.9970044", icon = "swap_horizontal_line")
```

Column {data-width=500}
-----------------------------------------------------------------------

Low Physical Activity

### Low Physical Activity has significant effect on number of deaths caused by high blood pressure
```{r}
valueBox("p-value < 2.2e-16", icon = "swap_horizontal_line")
```


### Strong, linear and positive effect
```{r}
e<-ggplot(mydata, aes(x=HighBloodPressure, y=LowPhysicalActivity)) + geom_point() + geom_smooth(method = "lm", se = FALSE)
ggplotly(e)
```

### Correlation
```{r}
valueBox("0.9887101", icon = "swap_horizontal_line")
```

Multiple Linear regression
======================================================================
Obesity has the more significant effect on the number of deaths caused by high blood pressure compared to low physical activity.

Column {data-width=500}
-----------------------------------------------------------------------

### Estimated additional percentage point by Obesity
```{r}
valueBox("1.4249", icon = "swap_horizontal_line")
```

Column {data-width=500}
-----------------------------------------------------------------------

### Estimated additional percentage point by Low Physical Activity
```{r}
valueBox("0.4189", icon = "swap_horizontal_line")
```

